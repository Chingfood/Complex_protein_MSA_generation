=========
Abstract:
=========

Generate the MSA for complex contact by using the genomic distance method and phylogenic distance method

======
Usage:
======

Usage: ./a3m_generating.sh [ -t TempDir ] [-f Uniref_path_header] <seq1> <seq2> [nCPU] [GPU_id]
if do not specify the temprary directory, a random temporary directory will be generated.
if do not specify the Uniref_path_header for HHblits, /mnt/local/qingyliu/uniref30_2020_06/UniRef30_2020_06 is used.
if do not specify the nCPU, 20 CPU core is used.
if do not specify the GPU_id, GPU:0 will be used. However, there is no GPU used in this execution.

================
Running example:
================

run:
        bash a3m_generation/a3m_generating.sh -t tmp.n4Tv4M9VfB/ -f $Loc/uniref30_2020_06/UniRef30_2020_06 ZTMA.fasta ZTMB.fasta
===================

===================
Prerequisite/Input:
===================

Before running the script, here are some prerequisite:
        1. Have the Uniref library available for HHblits. The uniref database on raptorx6 is located at: /mnt/local/qingyliu/uniref30_2020_06/

	2. Have the genomic distance library linked to the right file.
		a) ln -sf TempDir/2020_06/id_loc_2020_06 a3m_generating/AlignZTM/id2loc

	3. Have the phylogenic distance library linked to the right file.
                a) ln -sf tmp.QzPYposjvv/names.dmp_species_taxid_better_fixed3_TaxTree a3m_generation/MSA_ConCat_Package/data/names.dmp_species_taxid_better_fixed3_TaxTree

	4. If needed, change the hhblits parameter in a3m_generating.sh
 
        5. If the HHblits is too old or a new version is available. Get the new copy of hhblits to the MSA_Concat_package and link the hhsuite to the newest hhblits. Here is the example:
                a) mv hhsuite-3.2.0-SSE2-Linux a3m_generation/MSA_ConCat_Package/
                b) ln -sf a3m_generation/MSA_ConCat_Package/hhsuite-3.2.0-SSE2-Linux a3m_generation/MSA_ConCat_Package/hhsuite
                c) rm -r hhblits_old/

=============
output files:
=============

Single_MSA/seq1.a3m & Single_MSA/seq2.a3m

	- The a3m file generated by HHblits

Single_MSA/seq1.a3m_nogap & Single_MSA/seq2.a3m_nogap

	- The a3m file where gap in alignments has been omitted.

Single_MSA/seq1.a3m_specbloc & Single_MSA/seq2.a3m_specbloc

	- The a3m file after gap is eliminated and add the species block information to the sequence header.

Merged_MSA_Genomic/seq1_seq2.a3m_raw & Merged_MSA_Genomic/seq2_seq1.a3m_raw

	- The MSA for the two sequence concatenated based on genomic distance

Merged_MSA_Genomic/seq1_seq2.a3m & Merged_MSA_Genomic/seq2_seq1.a3m

	- The MSA for the two sequence concatenated based on genomic distance after using hhfilter to filter out a few alignment sequence.

Merged_MSA_Phylogenic/seq1_seq2.a3m_raw & Merged_MSA_Phylogenic/seq2_seq1.a3m_raw

	- The MSA for the two sequence concatenated based on phylogenic distance

Merged_MSA_Phylogenic/seq1_seq2.a3m & Merged_MSA_Phylogenic/seq2_seq1.a3m

	- The MSA for the two sequence concatenated based on phylogenic distance after using hhfilter to filter out a few alignment sequence.


